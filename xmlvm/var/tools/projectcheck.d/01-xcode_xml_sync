echo Checking Xcode templates

sync_file () {
	CHECK=`diff $1 $2`
	if [ -n "$CHECK" ] ; then
		echo "File $2 is out of sync:"
		diff "$1" "$2"
		echo -n "Press [RETURN] to update this file, or [CTR]-C to cancel: "
		read QQ
		cp "$1" "$2"
		echo
	fi
}

# check_xcode_template_files
CHECK=`diff  var/templates/iphone/xcode.xml var/templates/iphone/xcode.xml-xmlvm_version | grep -v "update 'nbproject/project.properties' file and define the path location of 'xmlvm.jar'" | wc -l | tr -d " "`
if [ "$CHECK" != "2" ] ; then
	echo "Generic xcode.xml template and xmlvm-based template does not match. Launching xxdiff"
	xxdiff  var/templates/iphone/xcode.xml var/templates/iphone/xcode.xml-xmlvm_version &
	exit 1
fi

# Check template files
sync_file var/templates/iphone/xcode.xml var/templates/android/xcode.xml
sync_file var/templates/iphone/xcode.xml-xmlvm_version var/templates/android/xcode.xml-xmlvm_version

# Check iphone target
for i in $IPHONE_PROJECTS ; do
	sync_file var/templates/iphone/xcode.xml-xmlvm_version demo/iphone/$i/nbproject/xcode.xml
done
for i in $ANDROID_PROJECTS ; do
	sync_file var/templates/android/xcode.xml-xmlvm_version demo/android/$i/nbproject/xcode.xml
done

# Check android target
for i in $ANDROID_PROJECTS ; do
	sync_file var/templates/android/androidsupport.xml demo/android/$i/nbproject/androidsupport.xml
done

